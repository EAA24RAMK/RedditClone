@using RedditAPP.Data;
@using Model;
@inject ApiService apiService

<style>
div.create-comment {
  background-color: #f2f0eb;
  width: 600px;
  border: 2px solid #452d3d;
  padding: 10px;
  margin-top: 20px;
}
</style>

<div class="create-comment">
    <h3>Write a comment</h3>
    <input placeholder="Your name" type="text" @bind="authorName" />
    <p></p>
    <input placeholder="Comment text" type="text" @bind="text" />
    <p></p>
    <button type="button" @onclick="CreateNewComment">Post comment</button>
</div>
<p></p>

@code {
    // PostId is passed in from the parent component. See how in PostItem.razor.
    [Parameter]
    public int PostId { get; set; }
    private string? authorName;
    private string? text;
    
    private async Task CreateNewComment()
    {
        if (string.IsNullOrWhiteSpace(text) || string.IsNullOrWhiteSpace(authorName))
            return;

        var newComment = await apiService.CreateComment(PostId, text, authorName);

        if (newComment != null)
        {
            // Rydder input felter efter post
            text = string.Empty;
            authorName = string.Empty;
        }
    }
}

@using Model;
@using RedditAPP.Data;
@inject ApiService apiService

<style>
div.create-post {
  background-color: #f2f0eb;
  width: 600px;
  border: 2px solid #452d3d;
  padding: 10px;
  margin-top: 20px;
}
</style>

<div class="create-post">
    <h3>Create a Post</h3>
    
    <input placeholder="Title" @bind="title" />
    <p></p>
    <input placeholder="Link (optional)" @bind="url" />
    <p></p>
    <textarea placeholder="Text (optional)" @bind="text"></textarea>
    <p></p>
    <input placeholder="Your name" @bind="authorName"/>
    <p></p>
    <button @onclick="CreateNewPost">Create Post</button>
    <p></p>
</div>

@code {
    private string? title;
    private string? url;
    private string? text;
    private string? authorName;
    
    [Parameter]
    public EventCallback OnPostCreated { get; set; }

    private async Task CreateNewPost()
    {
        if (string.IsNullOrWhiteSpace(title) || string.IsNullOrWhiteSpace(authorName))
            return;

        var newPost = await apiService.CreatePost(title!, url, text, authorName!);
        
        // Ryd felterne
        title = string.Empty;
        url = string.Empty;
        text = string.Empty;
        authorName = string.Empty;
        
        // Fort√¶l parent at post skal reloaedes
        await OnPostCreated.InvokeAsync();
    }

}